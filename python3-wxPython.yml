name: python3-wxPython
buildsystem: simple
build-commands: []
modules:
  - name: python3-wxPython
    buildsystem: simple
    build-commands:
      # Zip up a self-created wxPython-4.2.0a1.zip to contain ./bin/waf-2.0.22
      # and ./ext/wxWidgets (populated by recursive git clone), and modify
      # setup.py to also run codegen.
      - cp waf-2.0.22 wxPython/bin/
      - patch -dwxPython -p1 <0001_wxPython_Run-codegen-via-setup.py.patch
      - tar czf wxPython-4.2.0a1.tar.gz wxPython
      # Now install the modules
      - pip3 install --verbose --exists-action=i --no-index --no-build-isolation --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} wxPython
    build-options:
      env:
        DOXYGEN: /app/bin/doxygen
        WXPYTHON_BUILD_ARGS: --use_syswx --nodoc
    cleanup:
      - /bin
    sources:
      - type: file
        url: https://files.pythonhosted.org/packages/13/b1/0c22aa7ca1deda4915cdec9562f839546bb252eecf6ad596eaec0592bd35/numpy-1.23.1.tar.gz
        sha256: d748ef349bfef2e1194b59da37ed5a29c19ea8d7e6342019921ba2ba4fd8b624
        x-checker-data:
          type: pypi
          name: numpy
      - type: file
        url: https://files.pythonhosted.org/packages/8c/92/2975b464d9926dc667020ed1abfa6276e68c3571dcb77e43347e15ee9eed/Pillow-9.2.0.tar.gz
        sha256: 75e636fd3e0fb872693f23ccb8a5ff2cd578801251f3a4f6854c6a5d437d3c04
        x-checker-data:
          type: pypi
          name: Pillow
      - type: git
        url: https://github.com/wxWidgets/Phoenix.git
        commit: edf1cf070b6cd927227d86abb2658b772ec36061
        dest: wxPython
        # Disable data checker until we have a new official release of wxPython
        #x-checker-data:
        #  type: pypi
        #  name: wxPython
      # We need to modify the wxPython source until they finally release a new version
      - type: file
        url: https://waf.io/waf-2.0.22
        sha256: 0a09ad26a2cfc69fa26ab871cb558165b60374b5a653ff556a0c6aca63a00df1
      - type: file
        path: patches/0001_wxPython_Run-codegen-via-setup.py.patch
